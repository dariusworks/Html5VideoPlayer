/*
html5版的视频播放器
author zsdroid
*/
var Html5VideoPlayer=function(a){this.isUseBlob=!(void 0!==a.isUseBlob&&!1===a.isUseBlob);this.vWidth=a.vWidth||200;this.vHeight=a.vHeight||100;this.vSrc=a.vSrc||"";this.vZIndex=a.vZIndex||100;this.vPoster=a.vPoster||"";this.vShowLightSwitch=void 0!=a.vShowLightSwitch?a.vShowLightSwitch:!0;this.vHaveLight={onText:"\u5f00\u706f",onIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABh0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjEwcrIlkgAAAnlJREFUOE9tk01oWkEQx1ftoemlXyAEcioNtBGhPQZKEHrPJSiigpDY0gTUKhT1JFERcggGT1WQ6KHaSyu1KthopfEjJlVbjKgFBTWCX4nEg+hBfZ19VSu8LPzYeTM7/5l9u0sjCALh4XK5yJlOpyMajfYEzKfj8fgugEajUXc4HOb7/X5hMBiQ65RKJTkjLIBxOp0YGgit+Xw+Rblcdl9eXkYrlUook8l8BP9bs9m8tr+/TwNmeTPDbrcjh8Ox4vF4lL1e70+n08k2m82f2Wz2WyQS8V9cXJzZbDaFTqdb0Wq1VAGr1YosFgsXKnuvr6/z7XY71Wq1kvl8PnR0dPT59PQ0kMvl3Gq1mqtSqagCBwcHyGQySbrdbhYSyeRarRZPpVL+QCDwKRaLecB3JpPJXkmlUqqAwWBAer1+a1L1O66Mk4PBoBt3kEwm/dBVXCKRbMGgCmg0GgTtrR8fHzvS6fQPnIQr4zmRSHwtlUpRiH0QiUTrQqGQKqBQKJBcLl8CkZ1qtXoSj8d90Wj0C1T2FQqFEPzQs+3t7R0ej7cE3CwA+0Obm5urRqNRAwkZ2EawWCyGrq6usru7uxoul7uKk28UEAgEaAKdz+dvhMNhJxzdCXQTwzYkbwB0AGGm92dmTAOTeXlvb+9do9H4Xa/Xf2Eb/MvzaygCLBaLVJ6wIBaL38CJnOOtYBv8C9M4k8mkdvDvYiPE4XBIETab/drr9RJwNwgGg/EeF8BMB6WDWWQiggXgBxJut5sUmI/Pv6H/rcBDhMBt4D6wiAXg/InDw8OpwCL4HwB38KO9qQMGBO4Bj4Bn8KRfAAHgHL5fAs+Bx8BD4NZU4C9hkBlGyPjr5wAAAABJRU5ErkJggg==",
offText:"\u5173\u706f",offIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAm5JREFUeNp0U81vElEQf+/tB9sFSiFCKSTWiolA7cdBYzTRYLQ3z8ZrD5oYD3r10Hjy4B/QkyZ60IMfJxOT2sZmQ4ipacTSSAmliBzED6CUApWF/XAesC00dJLJzM7M7/dmdt7Duq4jKq8eYmQIxsgPJgApO82C3QWNKypKqGq7ZvZxG8eiXqEsl23u4Nnx0J2QzTPqrddzeuln5lcy8jaynUt7IL9MOQ0AMRxVQ0jTUdA2cub8ldlndx3HA+MIq2JdzvGqkPVfuPng9qD79EXoYqqpHJy4T6ABAbQ3NXnt3lVVqxFNazRpgwwjIEUpK6WdFTw9cysEBOcU7YBgfwSlPduxIY/PpygVGbh1AGqy/AfImxgIVYd3bLShoGFdP5qAbcgFpba3qWJMWuBqdYslxEQ4bggjnWlCX6QvQWeufDYeSQ56yXS1mvxHT2YYnphMHmw2n+R+bKwlgeB3918n3R0AyaeV9y+/mgcm6jzv5AXBzYiij5jNpxgTd6K+/GY+Bj9b6nTbS4Da+07vFIufl17ML7iHrwtWa5CI4hgBa3r35NHibikfgZrNvh2UqwhV9lpdLKbj0fT3b/F1nndxLGthtmJf1jOJVQpcOHRveu9BR1U4JZxY/bgBYI5hLDz1oSRMy44kkGI98VQ2GZUxZjAhLKY+jRnJ5x/6bEFaa+uNGRdyOp21cJRkJiMDrlQqheaeyvZLE6hm1HXL4beAXi/9RaFQELwiCgT8qNHgUT9gvy1QXwC1S5I0QgOFQgGVy3kjT2MOULEbh43njGFgMNZO0SB8W8DOgXqg5j7YbdAKaIkuDWKtq/dfgAEARTYbucps2QYAAAAASUVORK5CYII="}};
Html5VideoPlayer.prototype.CallBack=function(a){this.vCallBack=a};
var FullScreen=function(a){var b=!1;a.addEventListener("dblclick",function(){b?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen?a.webkitRequestFullScreen():a.msRequestFullscreen&&a.msRequestFullscreen();
b=!b},!1)},LightSwitch=function(a,b){var c="shadow_"+(new Date).getTime(),d="#"+c+"{\t\tposition:absolute;\t\tbackground-color:gray;\t\tleft:0;\t\ttop:0;\t\twidth:100%;\t\theight:100%;\t\tz-index:"+a.vZIndex+";}",e=document.createElement("style");e.innerHTML=d;document.head.appendChild(e);var f=document.createElement("div");f.id=c;f.style.display="none";b.appendChild(f);var g='<img src="'+a.vHaveLight.offIcon+'"/>'+a.vHaveLight.offText,h='<img src="'+a.vHaveLight.onIcon+'"/>'+a.vHaveLight.onText,
c=document.createElement("span");c.id="light_"+(new Date).getTime();c.className="close-light";c.style.top=20;c.style.position="absolute";c.style["z-index"]=a.vZIndex+2;c.style.left=a.vWidth;c.innerHTML=g;c.addEventListener("click",function(){"close-light"==this.className?(this.innerHTML=h,this.className="open-light",f.style.display="block"):(this.innerHTML=g,this.className="close-light",f.style.display="none")});b.appendChild(c)};
Html5VideoPlayer.prototype.blob=function(a,b){var c=new XMLHttpRequest;c.open("GET",b,!0);c.responseType="blob";c.onload=function(b){200==this.status&&(a.src=URL.createObjectURL(this.response))};c.send(null)};
Html5VideoPlayer.prototype.Create=function(a){this.videoPlayerQuerySelector=document.querySelector(a);a=document.createElement("div");a.id="Html5VideoPlayer_"+(new Date).getTime();this.videoPlayerQuerySelector.appendChild(a);var b=document.createElement("video");b.id="video_"+(new Date).getTime();b.innerHTML="\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301html5 video!";b.loop=1;b.controls=1;b.style.position="absolute";b.style["z-index"]=this.vZIndex+2;""!=this.vPoster&&(b.poster=this.vPoster);b.width=
this.vWidth;b.height=this.vHeight;this.isUseBlob?this.blob(b,this.vSrc):b.src=this.vSrc;a.appendChild(b);FullScreen(b);this.vShowLightSwitch&&LightSwitch(this,a);document.addEventListener("keydown",function(){var a=d.GetCurrentTime(),b=d.GetVolume();switch(event.keyCode){case 37:e.SetCurrentTime(a-5);break;case 39:e.SetCurrentTime(a+5);break;case 38:e.SetVolume(b+.1);break;case 40:e.SetVolume(b-.1);break;case 32:d.GetInfo("paused")?e.SetPlay():e.SetPause()}},!1);if(null!=b.error)console.log(b.error.code,
{1:"\u7528\u6237\u7ec8\u6b62",2:"\u7f51\u7edc\u9519\u8bef",3:"\u89e3\u7801\u9519\u8bef",4:"URL\u65e0\u6548"}[b.error.code]);else{var c=this,d={GetInfo:function(a){a=a||null;var c={paused:b.paused,ended:b.ended,duration:b.duration,muted:b.muted,currentTime:b.currentTime,volume:b.volume};return null!=a&&void 0!=c[a]?c[a]:c},GetVolume:function(){return b.muted?0:b.volume},GetCurrentTime:function(){return b.currentTime}};a=function(a){b.addEventListener(a,function(){void 0!=c.vCallBack&&void 0!=c.vCallBack[a]&&
c.vCallBack[a].call(d)},!1)};a("loadstart");a("suspend");a("abort");a("progress");a("error");a("stalled");a("play");a("pause");a("loadedmetadata");a("waiting");a("playing");a("canplay");a("canplaythrough");a("seeking");a("seeked");a("timeupdate");a("ended");a("ratechange");a("durationchange");a("volumechange");var e={SetCurrentTime:function(a){b.currentTime=a||0},SetVolume:function(a){b.volume=a||0},SetMuted:function(a){b.muted=a||!0},SetPause:function(){b.pause()},SetPlay:function(){b.play()}};return e}};
